"use strict";function initMap(){function o(){window.setTimeout(function(){showPrisons()},200)}map=new google.maps.Map(document.getElementById("map-canvas"),{center:new google.maps.LatLng(51.519132,(-.094205)),zoom:11}),showPrisons(),newPrisonsListener=map.addListener("center_changed",o),$(".tabs").hide(),$(".trains").on("click",showTrains),$(".airports").on("click",showAirports)}function showPrisons(){var o={location:map.getCenter(),radius:"50000",query:"prison"};service=new google.maps.places.PlacesService(map),service.textSearch(o,searchForPrison)}function searchForPrison(o,n){if(n===google.maps.places.PlacesServiceStatus.OK)for(var e=0;e<o.length;e++){var t=o[e];createMarkerPrison(t,map)}}function createMarkerPrison(o,n){var e=new google.maps.Marker({position:o.geometry.location,map:n,icon:"https://cdn0.iconfinder.com/data/icons/small-n-flat/24/678111-map-marker-32.png"});prisonMarkers.push(e),e.addListener("click",function(){n.setCenter(e.getPosition())}),infoWindowPrison(o,e)}function infoWindowPrison(o,n){google.maps.event.addListener(n,"click",function(){"undefined"!=typeof infoWindow&&infoWindow.close(),infoWindow=new google.maps.InfoWindow({content:"<h4>"+o.name+"</h4>\n                <p>"+o.formatted_address+'</p>\n                <button class="myPrison waves-effect waves-teal btn-flat">Escape from here</button>'}),infoWindow.open(map,n),$("body").on("click",".myPrison",function(){map.setZoom(15),infoWindow.close(),clearMarkers(),createMarkerPrison(o,map),google.maps.event.removeListener(newPrisonsListener),prisonObject.address=o.formatted_address,getPrisonLatLng(prisonObject.address),console.log(prisonObject),$(".tabs").show()})})}function getPrisonLatLng(o){var n=o.split(" ").join("+");console.log(n);var e="https://maps.googleapis.com/maps/api/geocode/json?address="+n+"&key=AIzaSyDXaR7rUFJyMSNs2AIRsKRiwvNVTso_8lY";$.ajax(e).done(function(o){prisonObject.lat=o.results[0].geometry.location.lat,prisonObject.lng=o.results[0].geometry.location.lng})}function clearMarkers(){setMapOnAll(null)}function setMapOnAll(o){prisonMarkers.forEach(function(n){n.setMap(o),prisonMarkers=[]})}function showTrains(){var o={location:{lat:prisonObject.lat,lng:prisonObject.lng},radius:"50000",query:"rail station"};service=new google.maps.places.PlacesService(map),service.textSearch(o,searchForStations),map.setZoom(12),$(".trains").html("Hide trains")}function searchForStations(o,n){if(n===google.maps.places.PlacesServiceStatus.OK)for(var e=0;e<o.length;e++){var t=o[e];createMarkerStation(t,map)}}function createMarkerStation(o,n){var e=new google.maps.Marker({position:o.geometry.location,map:n,icon:"https://cdn3.iconfinder.com/data/icons/mapicons/icons/steamtrain.png"});infoWindowStation(o,e)}function infoWindowStation(o,n){google.maps.event.addListener(n,"click",function(){"undefined"!=typeof infoWindow&&infoWindow.close(),infoWindow=new google.maps.InfoWindow({content:"<h4>"+o.name+'</h4>\n                <button class="waves-effect waves-teal btn-flat">get here</button>'}),infoWindow.open(map,n)})}function showAirports(){var o="https://api.sandbox.amadeus.com/v1.2/airports/nearest-relevant?apikey=yGCL11tesreUoG0MGKkjSYqMsAMwEju3&latitude="+prisonObject.lat+"&longitude="+prisonObject.lng;$.ajax(o).done(function(o){o.forEach(function(o){console.log(o),createMarkerAirport(o,map),map.setZoom(9)})})}function createMarkerAirport(o,n){var e={lat:o.location.latitude,lng:o.location.longitude},t=new google.maps.Marker({position:e,map:n,icon:"https://cdn4.iconfinder.com/data/icons/aiga-symbol-signs/612/aiga_air_transportation_bg-32.png"});infoWindowAirport(o,t)}function infoWindowAirport(o,n){google.maps.event.addListener(n,"click",function(){"undefined"!=typeof infoWindow&&infoWindow.close(),infoWindow=new google.maps.InfoWindow({content:"<h4>"+o.airport_name+"</h4>\n                <h6>Distance: "+o.distance+" km</h6>\n                <h6>Aircraft movements: "+o.aircraft_movements+'</h6>\n                <button class="waves-effect waves-teal btn-flat">get here</button>'}),infoWindow.open(map,n)})}var map=void 0,service=void 0,infoWindow=void 0,prisonMarkers=[],newPrisonsListener=void 0,prisonObject={},google=google;$(initMap);